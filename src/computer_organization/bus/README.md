# 总线

## 基本概念
1. 计算机中的部件之间需要互相连接，一种方式是各部件之间用单独的连线，称为**分散连接**（效率低，不灵活）；另一种方式是把各个部件连接到一组**公共信息传输线**上，称为**总线连接**。
2. 总线是连接**多个**部件的信息传输线，是各个部件共享的传输介质。注意：多个部件和总线相连时： 
    1. 可以同时从总线上接收**相同**的信息。
    2. **不可以**同时向总线发送信息。
3. 总线由许多  **传输线** 或 **通路** 组成。 每条线一次传输**一位**二进制代码，也可以用若干条传输线同时传输若干位二进制代码，如16根传输线组成的总线可以同时传输16位二进制代码。


## 使用总线连接的计算机结构

::: info 引入段落
这是一个**引入段落**， 详细内容请继续阅读 [总线结构](#总线结构)。
:::

### 双总线结构
#### 面向CPU的双总线结构
1. 一组总线称为**存储总线**（**M总线**），连接**CPU和主存**。
2. 一组总线称为**输入输出总线**）（**I/O总线**），连接**CPU和I/O设备**， 途径是各种I/O设备通过**I/O接口**挂载到I/O总线上。（便于增删设备）
![面向CPU的双总线结构框图](https://yunwu-images.oss-cn-shanghai.aliyuncs.com/%E9%9D%A2%E5%90%91CPU%E7%9A%84%E5%8F%8C%E6%80%BB%E7%BA%BF%E7%BB%93%E6%9E%84%E6%A1%86%E5%9B%BE.jpg)

#### 以存储器为中心的双总线结构
以存储器为中心的双总线结构是在[单总线结构](#单总线结构)的基础上新增一条**存储总线**，速度高，且只供主存和CPU之间传输信息。

作用： 提高传输效率，减轻系统总线负担，**且保留了I/O设备和主存交换信息时不经过CPU**的特点。

![以存储器为中心的双总线结构框图](https://yunwu-images.oss-cn-shanghai.aliyuncs.com/20230310154402.png)



### 单总线结构
![单总线结构框图](https://yunwu-images.oss-cn-shanghai.aliyuncs.com/20230310153531.png)


单总线结构下，CPU，主存和I/O设备都挂到**同一组主线上**）：
1. 优点： I/O设备（通过I/O接口）和主存交换信息时，原则上不影响CPU的工作，CPU仍可以继续处理不访问主存或I/O设备的操作，工作效率有所提高。
2. 缺点： 某一时刻多个部件需要占用总线时，会发生冲突。
3. 解决： 设置**总线判优逻辑**，按优先级高低来占用总线。


## 总线的分类
### 按数据传送方式
1. 并行传输总线（且按照传输数据宽度，分为8，16，32，64位等）
2. 串行传输总线

### 按使用范围
1. 计算机（包括外设）总线
2. 测控总线
3. 网络通信总线
4. 其它


### 按连接部件
#### 片内总线
指**芯片内部**的总线，如CPU内部，寄存器之间，寄存器和逻辑运算单元之间都使用**片内总线**连接。

#### 系统总线
指**CPU,主存，I/O设备（通过I/O接口）**各大部件之间的信息传输线，又称为**板级总线，板间总线**。

按传输信息的不同，分为三小类：
1. 数据总线：传输数据信息，是**双向传输**总线。位数和机器字长，存储字长有关，称为**数据总线宽度**，是衡量系统性能的重要参数。如数据总线的宽度为8位，指令字长为16位，CPU取指时需要**两次访问主存**。
2. 地址总线： 指出数据总线上源数据或目标数据在主存或I/O设备上的地址。地址总线上的代码由CPU输出，**单向传输**。 位数和存储单元的个数有关，即存储单元个数= $2^n$ 。
3. 控制总线： 负责发出各种控制信号，来协调被连接到同一组总线上的各个部件，防止出现冲突。**对任一控制线来说，它的传输是单向的。**对整体来说，可以认为是双向的。

#### 通信总线
用于计算机系统之间或计算机系统与其它系统之间的通信。

按传输方式分为两种：串行和并行。
1. 串行通信： 适合远距离传送。
2. 并行传输： 适合近距离传送。


## 总线特性和性能指标
### 总线特性
![总线结构的物理实现](https://yunwu-images.oss-cn-shanghai.aliyuncs.com/20230310221651.png)

1. 机械特性：尺寸、形状、管脚数及排列顺序。
2. 电气特性：传输方向和有效的电平范围。
3. 功能特性：每根传输线的功能（地址、数据或控制）。
4. 时间特性：信号的时序关系。

### 性能指标
1. 总线宽度：数据线的根数。
2. 标准传输率：每秒传输的最大字节数（MBps）。
3. 时钟同步/异步：总线上的数据是否与时钟同步工作。
4. 总线复用：地址线与数据线复用。
5. 信号线数：**地址线、数据线和控制线**的总和。
6. 总线控制方式：突发、自动、仲裁、逻辑、计数。
7. 其他指标：负载能力。


## 总线标准
::: info 等待完善

:::

## 总线结构
### 单总线结构
![单总线结构示意图](https://yunwu-images.oss-cn-shanghai.aliyuncs.com/20230310223034.png)

单总线结构的问题：随着计算机应用范围的扩大，外部设备的种类和数量不断增加，当I/O设备量很大，总线发出的控制信号需要从一端逐个顺序传递到n个设备。

### 多总线结构
#### 双总线结构
![双总线结构示意图](https://yunwu-images.oss-cn-shanghai.aliyuncs.com/20230310223123.png)
双总线结构的特点： 将速度较低的I/O设备分离出来，使主存和I/O设备分开。 **通道**是一种特殊的处理器，对I/O设备有统一管理的功能，从而实现外部设备和主存储器的数据传送。

#### 三总线结构
![三总线结构示意图](https://yunwu-images.oss-cn-shanghai.aliyuncs.com/20230310224354.png)
三总线结构特点： 在双总线结构的基础上，把I/O设备进一步按传输速率分类，连接在不同的通道上。

图中的**DMA总线**用于**高速I/O设备**与主存**直接交换信息**。（三总线结构中，任一时刻**只能使用一种总线**，因此不存在DMA总线和主存总线同时对主存进行存取的情况）。

以下是另一种三总线结构：
![另一种三总线结构](https://yunwu-images.oss-cn-shanghai.aliyuncs.com/20230310224756.png)

#### 四总线结构
![四总线结构示意图](https://yunwu-images.oss-cn-shanghai.aliyuncs.com/20230310225028.png)